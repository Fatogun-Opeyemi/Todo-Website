<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/flowbite@2.4.1/dist/flowbite.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="todo.css">
    
</head>
<body>
    <section id="sectionForImage">
        <img src="/img/Mobile note list.gif" alt="">
        
    </section>
    
    <section id="sectionForOthers">
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop" style="display: none;">
            Launch static backdrop modal
        </button>
        
        <!-- Modal -->
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="staticBackdropLabel">Edit</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    
            <div class="input-group input-group-sm mb-3">
                <span class="input-group-text" id="inputGroup-sizing-sm">Kindly edit your task</span>
                <input type="text" id="editInput" class="form-control modal-body mx-1" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" id="closeEditModal" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-outline-primary" id="saveEditModalChanges" data-bs-dismiss="modal">Save changes</button>
            </div>
        </div>
    </div>
    </div>
    
    <!-- Modal for delete -->
    <button id="toggle" data-modal-target="popup-modal" data-modal-toggle="popup-modal" class="block text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" type="button"  style="display: none;">
        Toggle modal
    </button>
    
    <div id="popup-modal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
        <div class="relative p-4 w-full max-w-md max-h-full">
            <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="popup-modal">
                    <svg onclick="closeModal()" class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
                <div class="p-4 md:p-5 text-center">
                    <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                    </svg>
                    <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Are you sure you want to delete this product?</h3>
                    <button id="yesButton" data-modal-hide="popup-modal" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center">
                        Yes, I'm sure
                    </button>
                    <button onclick="closeModal(), showAlert()" data-modal-hide="popup-modal" type="button" class="py-2.5 px-5 ms-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">No, cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- editAler Button -->
    <div id="liveAlertPlaceholder"></div>
    <button type="button" class="btn btn-outline-primary d-none" id="liveAlertBtn" >Show live alert</button>
    <!--  -->
    
    <article id="article">
        
    </article>
    <header class="fw-bold fs-1 p-3 text-center" style="color: saddlebrown;" id="taskList">
        Tasks List
    </header>
    
    
    <main id="main" class="text-center d-flex justify-center" style="overflow-wrap: break-word; ">
        <button  id="addTASK" onclick="addButton()" class="btn w-50" style="background-color: saddlebrown;">Add Tasks</button>
        <!-- <button  id="addTASK" onclick="addButton()" class="focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm  dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800 w-50 shadow-none " >Add Tasks</button> -->
        <span id="span" class="mx-3 my-3 p-3"></span>
        
        <!-- <hr class="w-100 mx bg-color-danger"> -->
    </main>
    
    <table class="table table-striped border border-gray-300 table-bordered table-responsive w-75 mx-auto my-3 table-hover text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400" id="table"></table>

    </section>

    <script src="/todo.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flowbite@2.4.1/dist/flowbite.min.js">
</script>
<script>
    
    const allTasks = []
    const main = document.getElementById('main')
    const span = document.getElementById('span')
    const article = document.getElementById('article')
    const popupModal = document.getElementById('popup-modal')
    const editPopup= document.getElementById('staticBackdrop')
    const editInput= document.getElementById('editInput')
    const closeEditModal= document.getElementById('closeEditModal')
    const saveEditModalChanges= document.getElementById('saveEditModalChanges')
    const table = document.getElementById('table')
    const noButton= document.getElementById('noButton')
    const alert = document.getElementById('alert')
    var toggle = document.getElementById('toggle');
    toggle.style.display = 'none';
    let deleteIndex = null;
    // let alert;
    
    
    
    const updateTable = () =>{
        table.innerHTML=''
        table.innerHTML +=`<tr class='text-center '>
            <th class='col-lg-1'>S/N</th>
            <th class='col-lg-8'>Task</th>
            <th class='col-lg-3'>Action</th>
            </tr>`
            
            console.log(allTasks);
            
            for (j = 0 ; j < allTasks.length; ++j){
                
                table.innerHTML +=`<tr>
                    <td class='text-center'>${j+1}</td>
                    <td class='text-center'>${allTasks[j]}</td>
                    
                    <td class='mx-auto'>
                        <button
                                data-modal-target="popup-modal" data-modal-toggle="popup-modal" class='btn btn-outline-primary text-dark  hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-sm rounded-lg text-sm px-2 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 shadow-none ' onclick='deleteItem(${j})'>Delete
                            </button>
                            
                            <button
                            class='btn btn-outline-danger' data-bs-toggle="modal" data-bs-target="#staticBackdrop"  onclick='editItem(${j})'>Edit
                            </button>
                        </td>
                        </tr>`
                    }
                }
                
                
        const addButton = () => {
            let promptForAdding = prompt('Add Task')

            if ( allTasks.length>0 && promptForAdding !== null && promptForAdding !== undefined && promptForAdding !== ''){
                    
                    allTasks.push(promptForAdding)
                    console.log(allTasks);
                    editAlert()
                    updateTable()
                    // updateTable()
                } 
                    else if(allTasks.length>=1 && promptForAdding === ''){
                    // document.getElementById('alert').style.display = 'block'
                    table.style.display = 'block'
                    showAlert()
                    updateTable()
                }else if(promptForAdding !== null && promptForAdding !== undefined && promptForAdding !== ''){
                    
                    allTasks.push(promptForAdding)
                    console.log(allTasks);
                    editAlert()
                    updateTable()
                    // updateTable()
                } 
                else{
                    // alert('Action cancelled')
                    showAlert();
                    // updateTable()
                    
                }
                
                
                
                // updateTable()    

                // let closeAlert = (alert) =>{
                //     document.getElementById('alert').style.display = 'none';
                //     let alertClose = document.getElementById('alertClose')
            
                //     alertClose.addEventListener('click' , closeAlert)
                // }
                
            }

            
            
            // const deleteItem = (index) =>{
                
            
            //     if(allTasks.length>=1){
                //         allTasks.splice(index,1)
                //         console.log(allTasks);
                //         updateTable()
                
                //     }
                
                //     }
                
                let modal = document.getElementById('popup-modal');
                let body = document.body    
                
                const deleteItem = (index) =>{
                deleteIndex = index
                let yesButton = document.getElementById('yesButton')
                modal.style.marginLeft= 'auto';
                modal.style.marginTop= 'auto';
                modal.style.display='block'
                body.style.backgroundColor= 'rgba(0, 0, 0, 0.5)'
                table.style.backgroundColor = 'rgba(0, 0, 0, 0.5)'
                
                
                
            }
            
            
            const closeModal = () =>{
                popupModal.style.display = 'none'
                body.style.backgroundColor= 'rgba(255,255,255, 0)'
                table.style.backgroundColor = 'rgba(255,255,255, 0)'
                
            }

            function showAlert() {
                article.innerHTML = `
                    <div 
                        id="showAlert"
                        class="alert alert-warning alert-dismissible fade show" role="alert">
                    <span>
                        Operation failed or cancelled.
                    </span> 
                    <button
                        type="button" class="btn-close btn-danger " data-bs-dismiss="alert" aria-label="Close" style="background-color:red; color:blue; font-size:1.1rem; margin:0;">X
                    </button>

                    </div>`;
            
                setTimeout(() => {
                    const alert = document.getElementById('showAlert');
                    if (alert) alert.remove();
                }, 2500);
            }
            
                            
                            const editAlert = ()=>{
                article.innerHTML=`
                <div id="editAlert" class="flex items-center p-4 mb-4 text-sm text-green-800 border border-green-300 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400 dark:border-green-800" role="alert">
                    <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                        </svg>
                        <span class="sr-only">Info</span>
                        <div>
                            <span class="font-medium">Action Successful!</span>
                            </div>
                            </div>`
    setTimeout(() => {
        const alert = document.getElementById('editAlert');
        if (alert) alert.remove();
    }, 2500);
                        }
                        
            //             function updateTableAfterEdit(index) {
            //                 //    allTasks[j]= editInput.value
            //                 // allTasks.splice(index,1, editInput.value)
            //                 allTasks[index] = editInput.value;
            //                 // table.innerHTML=''
            //     updateTable()
            //     editAlert()
                
            // }
            
            const editItem = (index) => {
                editInput.value = allTasks[index];
                saveEditModalChanges.onclick = () => {
                    allTasks[index] = editInput.value;
                    updateTable();
                    editAlert();
                };
            };
editItem()

            closeEditModal.onclick=()=>{
                showAlert()
                }



            
            const yes = () => {
                if(deleteIndex !== null){
                    allTasks.splice(deleteIndex,1)
                    
                            if(allTasks.length===0){
                                table.innerHTML=''
                            }else{
                                updateTable()
                            }
                            console.log(allTasks);
                            // modal.style.display='none'
                            closeModal()
                            
                }
                
                const no = ()=>{
                    closeModal()
                    noButton.addEventListener('click', closeModal())
                }
                
            }
            yesButton.addEventListener('click', yes)
            
            
            
            // const editItem = (index) => {
            //     var modal = document.getElementById('popup-modal');
            //     modal.style.display = 'block';
            //     modal.style.marginLeft= '35vw';
            //     modal.style.marginTop= '5.5vw';
            
            //     if(document.getElementById('yesButton')===onclick){
            //         allTasks.splice(index,1)
            //         updateTable()
            //         if(allTasks.length===0){
                //             table.innerHTML=''
                //         }else{
            //             updateTable()
            //         }
            //     }
            //     // You can also add code here to populate the modal with the task details
            // }
            
            
            //modal closing
            
            
            
            const alertPlaceholder = document.getElementById('liveAlertPlaceholder')
const appendAlert = (message, type) => {
    alertPlaceholder.innerHTML = ''
    const wrapper = document.createElement('div')
    wrapper.innerHTML = [
        `<div class="alert alert-${type} alert-dismissible" role="alert">`,
            `   <div>${message}</div>`,
            '   <button type="button" class=" btn btn-close btn-danger" data-bs-dismiss="alert" aria-label="Close" style="background-color:red; color:blue ; font-size:1.1rem ; margin:0"  ;>X</button>',
            '</div>'
        ].join('')
        
        alertPlaceholder.append(wrapper)
    }
    
const alertTrigger = document.getElementById('liveAlertBtn')
if (alertTrigger) {
    alertTrigger.addEventListener('click', () => {
        appendAlert('Nice, you triggered this alert message!', 'success')
    })
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>